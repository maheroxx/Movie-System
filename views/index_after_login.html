<html>
    <head>

    </head>

    <body>
        <h1>EigaMovie</h1>
        <h3>Welcome <span id="uname"></span></h3>

     
        <script src="../js/jquery-3.5.0.min.js"></script>
        <script src="js/customer.js"></script>
        <section class="profile">

        </section>
       
       <a href="#" class="logoutlink">Logout</a>

        <form action="/favourites" method="get">
            <input type="submit" value="Favourites">
            </form>

        <form action="/search" method="GET">
            <input type="text" name="keyword" id="keyword">
            <input type="submit" id="get_btn" value="Search">
        </form>

        <section class="movies">
            <h2>Movie List</h2>
            <table border="1px black"  class="movielist">
                <tr>
                    <th>Title</th>
                    <th>Description</th>
                    <th>Genre</th>
                    <th>Language</th>
                    <th>Ranking</th>
                    <th>Running Time</th>
                </tr>
              
            </table>

        </section>
        <script>
            $(document).ready(function(){
                $.ajax({
                    url: "/movies",
                    method: "get"
                })
                .done(
                    function(data){
                    
                        data.forEach(function(movie)
                        {
                            $('.movielist').append("<tr> <td>"+ movie.title + "</td> <td>"+ movie.description + "</td> <td>"+ movie.genre+ "</td> <td>"+ movie.language + "</td> <td>" + movie.ranking+ "</td> <td>" + movie.runningtime + "</td> <tr>");
                           
                        })
                    }
                )
            })
            $(document).ready(function(){
                $(".logoutlink").click(function(e){
                    e.preventDefault();

                    $.ajax({
                        url: "/logout?token="+sessionStorage.authToken,
                        method: "get"
                    })
                    .done(function(data){
                        sessionStorage.removeItem("authToken");
                        window.location.href="index";
                    })
                    .fail(function(err){
                        console.log(err.responseText);
                    })
                })
            })
        </script>
    </body>
</html>